<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-administer/upgrade">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="Firezone" href="/opensearch.xml">
<script src="/js/posthog.js" async></script><title data-rh="true">Upgrade | Firezone</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.firezone.dev/administer/upgrade"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="wireguard, vpn, firewall, remote access, network, documentation"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Upgrade | Firezone"><meta data-rh="true" name="description" content="Upgrading Firezone will disconnect all VPN sessions and require shutting"><meta data-rh="true" property="og:description" content="Upgrading Firezone will disconnect all VPN sessions and require shutting"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.firezone.dev/administer/upgrade"><link data-rh="true" rel="alternate" href="https://docs.firezone.dev/administer/upgrade" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.firezone.dev/administer/upgrade" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XXPZ9QVGFB-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ba4f3ef5.css">
<link rel="preload" href="/assets/js/runtime~main.819482c8.js" as="script">
<link rel="preload" href="/assets/js/main.9a7ad3b7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Firezone" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Firezone" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Documentation</b></a></div><div class="navbar__items navbar__items--right"><a href="https://discourse.firez.one/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" aria-label="GitHub repository">Ask a Question<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://e04kusl9oz5.typeform.com/to/gzzaZZ52#source=docsheader" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" aria-label="GitHub repository">Join the Beta<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/firezone/firezone" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/deploy">Deploy</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/authenticate">Authenticate</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authenticate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/administer">Administer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Administer&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/configure">Configure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/manage">Manage Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/administer/upgrade">Upgrade</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/uninstall">Uninstall</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/troubleshoot">Troubleshoot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/security-considerations">Security Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/administer/running-sql-queries">Running SQL Queries</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/user-guides">User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/reference">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/administer"><span itemprop="name">Administer</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Upgrade</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrade</h1></header><p>Upgrading Firezone will disconnect all VPN sessions and require shutting
down the Web UI. We recommend a maintenance window of about an hour in case
anything goes wrong during the upgrade.</p><p>To upgrade Firezone, follow these steps:</p><ol><li>If not setup already, install our package repository based on your distro&#x27;s
package format:<ul><li><a href="https://cloudsmith.io/~firezone/repos/firezone/setup/#formats-deb" target="_blank" rel="noopener noreferrer">deb packages</a></li><li><a href="https://cloudsmith.io/~firezone/repos/firezone/setup/#formats-rpm" target="_blank" rel="noopener noreferrer">rpm packages</a></li></ul></li><li>Upgrade the <code>firezone</code> package using your distro&#x27;s package manager.</li><li>Run <code>firezone-ctl reconfigure</code> to pick up the new changes.</li><li>Run <code>firezone-ctl restart</code> to restart services.</li></ol><p>Occasionally problems arise. If you hit any, please let us know by <a href="https://github.com/firezone/firezone/issues/new/choose" target="_blank" rel="noopener noreferrer">filing an
issue</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from--050-to--050">Upgrading from &lt; 0.5.0 to &gt;= 0.5.0<a class="hash-link" href="#upgrading-from--050-to--050" title="Direct link to heading">​</a></h2><p>0.5.0 introduces a few breaking changes and configuration updates that will need
to be addressed. Read more below.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bundled-nginx-non_ssl_port-http-requests-removed">Bundled Nginx non_ssl_port (HTTP) requests removed<a class="hash-link" href="#bundled-nginx-non_ssl_port-http-requests-removed" title="Direct link to heading">​</a></h3><p>0.5.0 and above removes the <code>force_ssl</code> and <code>non_ssl_port</code> settings for
Nginx. SSL is required for Firezone to function; if you&#x27;re using (or would like
to use) your own reverse proxy, we recommend disabling the bundle Nginx service
by setting <code>default[&#x27;firezone&#x27;][&#x27;nginx&#x27;][&#x27;enabled&#x27;] = false</code> and pointing your
reverse proxy directly to the Phoenix app on port 13000 (by default).</p><p>Read more about setting up a custom reverse proxy
<a href="/deploy/reverse-proxies">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="acme-protocol-support">ACME protocol support<a class="hash-link" href="#acme-protocol-support" title="Direct link to heading">​</a></h3><p>0.5.0 introduces ACME protocol support for automatically renewing SSL
certificates with the bundled Nginx service. To enable,</p><ul><li><p>Make sure <code>default[&#x27;firezone&#x27;][&#x27;external_url&#x27;]</code> contains a valid FQDN that
resolves to your server&#x27;s public IP address.</p></li><li><p>Ensure port <code>80/tcp</code> is reachable</p></li><li><p>Enable ACME protocol support with
<code>default[&#x27;firezone&#x27;][&#x27;ssl&#x27;][&#x27;acme&#x27;][&#x27;enabled&#x27;] = true</code> in your config file.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overlapping-egress-rule-destinations">Overlapping egress rule destinations<a class="hash-link" href="#overlapping-egress-rule-destinations" title="Direct link to heading">​</a></h3><p>Firezone 0.5.0 removes the ability to add rules with overlapping destinations.
When upgrading to 0.5.0, our migration script will automatically detect these
cases and <strong>keep only the rules whose destination encompasses the other rule</strong>.
If this is OK, <strong>there is nothing you need to do</strong>.</p><p>Otherwise, we recommend modifying your ruleset to eliminate these cases before
upgrading.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="preconfigured-okta-and-google-sso">Preconfigured Okta and Google SSO<a class="hash-link" href="#preconfigured-okta-and-google-sso" title="Direct link to heading">​</a></h3><p>Firezone 0.5.0 removes support for the old-style Okta and Google SSO
configuration in favor of the new, more flexible OIDC-based configuration.
If you have any configuration under the
<code>default[&#x27;firezone&#x27;][&#x27;authentication&#x27;][&#x27;okta&#x27;]</code> or
<code>default[&#x27;firezone&#x27;][&#x27;authentication&#x27;][&#x27;google&#x27;]</code> keys, <strong>you need to migrate
these to our OIDC-based configuration using the guide below.</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="existing-google-oauth-configuration">Existing Google OAuth configuration<a class="hash-link" href="#existing-google-oauth-configuration" title="Direct link to heading">​</a></h4><p>Remove these lines containing the old Google OAuth configs from your configuration
file located at <code>/etc/firezone/firezone.rb</code></p><div class="language-rb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;google&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;enabled&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;google&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;client_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;google&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;client_secret&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;google&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;redirect_uri&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, follow the instructions <a href="/authenticate/google">here</a> to configure Google
as an OIDC provider.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="existing-okta-oauth-configuration">Existing Okta OAuth configuration<a class="hash-link" href="#existing-okta-oauth-configuration" title="Direct link to heading">​</a></h4><p>Remove these lines containing the old Okta OAuth configs from your configuration
file located at <code>/etc/firezone/firezone.rb</code></p><div class="language-rb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;okta&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;enabled&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;okta&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;client_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;okta&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;client_secret&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;firezone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;authentication&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;okta&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&#x27;site&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, follow the instructions <a href="/authenticate/okta">here</a> to configure Okta as
an OIDC provider.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-03x-to--0316">Upgrading from 0.3.x to &gt;= 0.3.16<a class="hash-link" href="#upgrading-from-03x-to--0316" title="Direct link to heading">​</a></h2><p>Follow the instructions below based on your current version and setup:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="i-have-an-existing-oidc-integration">I have an existing OIDC integration<a class="hash-link" href="#i-have-an-existing-oidc-integration" title="Direct link to heading">​</a></h3><p>Upgrading to &gt;= 0.3.16 requires the <code>offline_access</code> scope for some OIDC providers
to obtain a refresh token.
This ensures Firezone syncs with the identity provider and VPN access is terminated
once the user is removed. Previous versions of Firezone do not have this capability.
Users who are removed from your identity provider will still have active VPN sessions
in some cases.</p><p>For OIDC providers that support the <code>offline_access</code> scope, you will need to add
<code>offline_access</code> to the <code>scope</code> parameter of your OIDC config. The
Firezone configuration file can be found at <code>/etc/firezone/firezone.rb</code> and requires
running <code>firezone-ctl reconfigure</code> to pick up the changes.</p><p>If Firezone is able to successfully retrieve the refresh token, you will see
the <strong>OIDC Connections</strong> heading in the user details page of the web UI for
users authenticated through your OIDC provider.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/52545545/173169922-b0e5f2f1-74d5-4313-b839-6a001041c07e.png" alt="OIDC Connections" class="img_ev3q"></p><p>If this does not work, you will need to delete your existing OAuth app
and repeat the OIDC setup steps to
<a href="/authenticate">create a new app integration</a> .</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="i-have-an-existing-oauth-integration">I have an existing OAuth integration<a class="hash-link" href="#i-have-an-existing-oauth-integration" title="Direct link to heading">​</a></h3><p>Prior to 0.3.11, Firezone used pre-configured OAuth2 providers. Follow the
instructions <a href="/authenticate">here</a> to migrate
to OIDC.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="i-have-not-integrated-an-identity-provider">I have not integrated an identity provider<a class="hash-link" href="#i-have-not-integrated-an-identity-provider" title="Direct link to heading">​</a></h3><p>No action needed. You can follow the instructions
<a href="/authenticate">here</a>
to enable SSO through an OIDC provider.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-031-to--032">Upgrading from 0.3.1 to &gt;= 0.3.2<a class="hash-link" href="#upgrading-from-031-to--032" title="Direct link to heading">​</a></h2><p>The configuration option <code>default[&#x27;firezone&#x27;][&#x27;fqdn&#x27;]</code> has been removed in favor
of <code>default[&#x27;firezone&#x27;][&#x27;external_url&#x27;]</code>. Please set this to the
publicly-accessible URL of your Firezone web portal. If left unspecified it will
default to <code>https://</code> + the FQDN of your server.</p><p>Reminder, the configuration file can be found at <code>/etc/firezone/firezone.rb</code>.
For an exhaustive list of configuration variables and their descriptions, see the
<a href="/reference/configuration-file">configuration file reference</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-02x-to-03x">Upgrading from 0.2.x to 0.3.x<a class="hash-link" href="#upgrading-from-02x-to-03x" title="Direct link to heading">​</a></h2><p>Starting with version 0.3.0, Firezone no longer stores device private
keys on the Firezone server. Any existing devices should continue to function
as-is, but you will not be able to re-download or view these configurations in
the Firezone Web UI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-01x-to-02x">Upgrading from 0.1.x to 0.2.x<a class="hash-link" href="#upgrading-from-01x-to-02x" title="Direct link to heading">​</a></h2><p>Firezone 0.2.x contains some configuration file changes that will need to be
handled manually if you&#x27;re upgrading from 0.1.x. Run the commands below as root
to perform the needed changes to your <code>/etc/firezone/firezone.rb</code> file.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> /etc/firezone/firezone.rb /etc/firezone/firezone.rb.bak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&quot;s/\[&#x27;enable&#x27;\]/\[&#x27;enabled&#x27;\]/&quot;</span><span class="token plain"> /etc/firezone/firezone.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default[&#x27;firezone&#x27;][&#x27;connectivity_checks&#x27;][&#x27;enabled&#x27;] = true&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/firezone/firezone.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default[&#x27;firezone&#x27;][&#x27;connectivity_checks&#x27;][&#x27;interval&#x27;] = 3_600&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/firezone/firezone.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firezone-ctl reconfigure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firezone-ctl restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/firezone/firezone/tree/master/docs/administer/upgrade.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/administer/manage"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Manage Installation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/administer/uninstall"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Uninstall</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#upgrading-from--050-to--050" class="table-of-contents__link toc-highlight">Upgrading from &lt; 0.5.0 to &gt;= 0.5.0</a><ul><li><a href="#bundled-nginx-non_ssl_port-http-requests-removed" class="table-of-contents__link toc-highlight">Bundled Nginx non_ssl_port (HTTP) requests removed</a></li><li><a href="#acme-protocol-support" class="table-of-contents__link toc-highlight">ACME protocol support</a></li><li><a href="#overlapping-egress-rule-destinations" class="table-of-contents__link toc-highlight">Overlapping egress rule destinations</a></li><li><a href="#preconfigured-okta-and-google-sso" class="table-of-contents__link toc-highlight">Preconfigured Okta and Google SSO</a></li></ul></li><li><a href="#upgrading-from-03x-to--0316" class="table-of-contents__link toc-highlight">Upgrading from 0.3.x to &gt;= 0.3.16</a><ul><li><a href="#i-have-an-existing-oidc-integration" class="table-of-contents__link toc-highlight">I have an existing OIDC integration</a></li><li><a href="#i-have-an-existing-oauth-integration" class="table-of-contents__link toc-highlight">I have an existing OAuth integration</a></li><li><a href="#i-have-not-integrated-an-identity-provider" class="table-of-contents__link toc-highlight">I have not integrated an identity provider</a></li></ul></li><li><a href="#upgrading-from-031-to--032" class="table-of-contents__link toc-highlight">Upgrading from 0.3.1 to &gt;= 0.3.2</a></li><li><a href="#upgrading-from-02x-to-03x" class="table-of-contents__link toc-highlight">Upgrading from 0.2.x to 0.3.x</a></li><li><a href="#upgrading-from-01x-to-02x" class="table-of-contents__link toc-highlight">Upgrading from 0.1.x to 0.2.x</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.firezone.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.firezone.dev/pricing" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pricing<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.firezone.dev/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://e04kusl9oz5.typeform.com/to/gzzaZZ52#source=docsfooter" target="_blank" rel="noopener noreferrer" class="footer__link-item">Join the Beta<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discourse.firez.one/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Support Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.firezone.dev/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/firezone/firezone" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/firezonehq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Firezone, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.819482c8.js"></script>
<script src="/assets/js/main.9a7ad3b7.js"></script>
</body>
</html>