"use strict";(self.webpackChunknew_docs=self.webpackChunknew_docs||[]).push([[3449],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),s=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return i.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,k=d["".concat(l,".").concat(m)]||d[m]||u[m]||a;return n?i.createElement(k,o(o({ref:t},c),{},{components:n})):i.createElement(k,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var s=2;s<a;s++)o[s]=n[s];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2867:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>s});var i=n(7462),r=(n(7294),n(3905));const a={title:"Okta",sidebar_position:2},o=void 0,p={unversionedId:"authenticate/okta",id:"authenticate/okta",title:"Okta",description:"Firezone supports Single Sign-On (SSO) using Okta",source:"@site/docs/authenticate/okta.md",sourceDirName:"authenticate",slug:"/authenticate/okta",permalink:"/authenticate/okta",draft:!1,editUrl:"https://github.com/firezone/firezone/docs/authenticate/okta.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Okta",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Google",permalink:"/authenticate/google"},next:{title:"Azure Active Directory",permalink:"/authenticate/azuread"}},l={},s=[{value:"Step 1 - Create Okta App Integration",id:"step-1---create-okta-app-integration",level:2},{value:"Integrate With Firezone",id:"integrate-with-firezone",level:2},{value:"Restricting Access to Certain Users",id:"restricting-access-to-certain-users",level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Firezone supports Single Sign-On (SSO) using Okta\nthrough the generic OIDC connector. This guide will walk you through how to\nobtain the following config settings required for the integration:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"discovery_document_uri"),": The\n",(0,r.kt)("a",{parentName:"li",href:"https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig"},"OpenID Connect provider configuration URI"),"\nwhich returns a JSON document used to construct subsequent requests to this\nOIDC provider."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"client_id"),": The client ID of the application."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"client_secret"),": The client secret of the application."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"redirect_uri"),": Instructs OIDC provider where to redirect after authentication.\nThis should be your Firezone ",(0,r.kt)("inlineCode",{parentName:"li"},"EXTERNAL_URL + /auth/oidc/<provider_key>/callback/"),"\n(e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"https://firezone.example.com/auth/oidc/okta/callback/"),")."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"response_type"),": Set to ",(0,r.kt)("inlineCode",{parentName:"li"},"code"),"."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"scope"),": ",(0,r.kt)("a",{parentName:"li",href:"https://openid.net/specs/openid-connect-basic-1_0.html#Scopes"},"OIDC scopes"),"\nto obtain from your OIDC provider. This should be set to ",(0,r.kt)("inlineCode",{parentName:"li"},"openid email profile offline_access"),"\nto provide Firezone with the user's email in the returned claims."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"label"),": The button label text that shows up on your Firezone login screen.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/52545545/156855886-5a4a0da7-065c-4ec1-af33-583dff4dbb72.gif",alt:"Firezone Okta SSO Login"})),(0,r.kt)("h2",{id:"step-1---create-okta-app-integration"},"Step 1 - Create Okta App Integration"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"This section of the guide is based on\n",(0,r.kt)("a",{parentName:"em",href:"https://help.okta.com/en/prod/Content/Topics/Apps/Apps_App_Integration_Wizard_OIDC.htm"},"Okta's documentation"),".")),(0,r.kt)("p",null,"In the Admin Console, go to ",(0,r.kt)("strong",{parentName:"p"},"Applications > Applications")," and click\n",(0,r.kt)("strong",{parentName:"p"},"Create App Integration"),". Set ",(0,r.kt)("strong",{parentName:"p"},"Sign-in method")," to ",(0,r.kt)("strong",{parentName:"p"},"OICD - OpenID Connect"),"\nand ",(0,r.kt)("strong",{parentName:"p"},"Application type")," to ",(0,r.kt)("strong",{parentName:"p"},"Web application"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/52545545/168918378-0dd9f705-2544-412d-bbbe-4a7cd9253907.png",alt:"Okta Create Options"})),(0,r.kt)("p",null,"On the following screen, configure the following settings:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"App Name"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"Firezone")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"App logo"),":\n",(0,r.kt)("a",{parentName:"li",href:"https://user-images.githubusercontent.com/52545545/155907625-a4f6c8c2-3952-488d-b244-3c37400846cf.png"},"Firezone logo"),"\n(save link as)."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Grant Type"),": Check the ",(0,r.kt)("strong",{parentName:"li"},"Refresh Token")," box. This ensures Firezone syncs\nwith the identity provider and VPN access is terminated once the user is removed."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Sign-in redirect URIs"),": Add your Firezone ",(0,r.kt)("inlineCode",{parentName:"li"},"EXTERNAL_URL + /auth/oidc/okta/callback/"),"\n(e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"https://firezone.example.com/auth/oidc/okta/callback/"),") as an entry to\nAuthorized redirect URIs."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Assignments"),":\nLimit to the groups you wish to provide access to your Firezone instance.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/52545545/172768478-e8be516d-aa0a-4882-b017-adc938bbd10b.png",alt:"Okta Settings"})),(0,r.kt)("p",null,"Once settings are saved, you will be given a ",(0,r.kt)("strong",{parentName:"p"},"Client ID"),", ",(0,r.kt)("strong",{parentName:"p"},"Client Secret"),",\nand ",(0,r.kt)("strong",{parentName:"p"},"Okta Domain"),". These 3 values will be used in Step 2 to configure Firezone."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/52545545/172768856-8a373d56-1362-4fc3-a747-3c84f0e76dae.png",alt:"Okta credentials"})),(0,r.kt)("h2",{id:"integrate-with-firezone"},"Integrate With Firezone"),(0,r.kt)("p",null,"Edit ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/firezone/firezone.rb")," to include the options below. Your ",(0,r.kt)("inlineCode",{parentName:"p"},"discovery_document_url"),"\nwill be ",(0,r.kt)("inlineCode",{parentName:"p"},"/.well-known/openid-configuration")," appended to the end of your ",(0,r.kt)("inlineCode",{parentName:"p"},"okta_domain"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ruby"},'# Using Okta as the SSO identity provider\ndefault[\'firezone\'][\'authentication\'][\'oidc\'] = {\n  okta: {\n    discovery_document_uri: "https://<OKTA_DOMAIN>/.well-known/openid-configuration",\n    client_id: "<CLIENT_ID>",\n    client_secret: "<CLIENT_SECRET>",\n    redirect_uri: "https://firezone.example.com/auth/oidc/okta/callback/",\n    response_type: "code",\n    scope: "openid email profile offline_access",\n    label: "Okta"\n  }\n}\n')),(0,r.kt)("p",null,"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"firezone-ctl reconfigure"),"and ",(0,r.kt)("inlineCode",{parentName:"p"},"firezone-ctl restart")," to update the application.\nYou should now see a ",(0,r.kt)("strong",{parentName:"p"},"Sign in with Okta")," button at the root Firezone URL."),(0,r.kt)("h2",{id:"restricting-access-to-certain-users"},"Restricting Access to Certain Users"),(0,r.kt)("p",null,"Okta can limit the users with access to the Firezone app. To do this,\ngo to the Assignments tab of the Firezone App Integration in your Okta\nAdmin Console."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/52545545/172766608-b95e20e2-eb58-4085-b532-84386de1ea23.png",alt:"Okta Assignments"})))}u.isMDXComponent=!0}}]);