import PlanBadge from "@/components/PlanBadge";
import Alert from "@/components/DocsAlert";
import SupportOptions from "@/components/SupportOptions";

<PlanBadge plans={["starter", "enterprise"]}>

# Configure DNS

</PlanBadge>

Firezone includes a sophisticated DNS routing system that provides Split DNS and
fallback resolver configuration for each client application in your Firezone
account. Read more below to understand how it works and how to configure it.

## How DNS works in Firezone

Each Firezone client embeds a lightweight DNS proxy that intercepts DNS queries
made by applications on the client device to route them appropriately.

When a user signs in, the client configures the host operating system to use
this proxy as the default resolver for all queries on the system.

For every query the proxy sees, it checks to see if it matches a resource the
user has access to. If it does, the proxy then finds an appropriate gateway
associated with the resource, forwards the query to be resolved on the gateway,
then returns the result back to the client to be returned to the application
making the query.

If the query doesn't match a resource, the proxy forwards the query to the
[upstream resolvers](#configuring-client-dns-upstream-resolvers) explained
below.

With this system, Firezone can provide Split DNS for all clients without
requiring any client side configuration.

## Configuring client DNS upstream resolvers

Upstream DNS in the clients can be overridden with servers of your choosing so
that clients' queries will use the servers you specify for all non-Firezone
resources.

For DNS names that don't match a defined resource, Firezone will use the
upstream resolvers defined at `Settings` -> `DNS` in the order they are defined.

If no custom resolvers are configured, Firezone clients will fall back to their
default system resolver, typically set by the DHCP server of their local
network.

To add custom resolvers, enter a valid IPv4 or IPv6 address and click "Save". To
remove, delete the IP address and click "Save".

<Alert color="info">
  Custom resolvers such as
  [Cloudflare](https://developers.cloudflare.com/1.1.1.1/setup/#1111-for-families)
  or [NextDNS](https://nextdns.io") can be used to block malware, ads, adult
  material and other content for all users in your Firezone account.
</Alert>

## Configuring Gateway resolvers

Firezone makes no assumptions about the DNS environment in which the gateway
runs. It uses the default system resolver you've configured on the gateway host.

This resolver is used for DNS resources defined in your Firezone account so it's
important that your gateway host has DNS configured properly for clients to
resolve names successfully.

<SupportOptions />
